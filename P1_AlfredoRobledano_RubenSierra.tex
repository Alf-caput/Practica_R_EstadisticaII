% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Prueba 1 - ANOVA},
  pdfauthor={Rubén Sierra Serrano y Alfredo Robledano Abasolo},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{Prueba 1 - ANOVA}
\author{Rubén Sierra Serrano y Alfredo Robledano Abasolo}
\date{2023-03-20}

\begin{document}
\maketitle

\hypertarget{creaciuxf3n-y-descripciuxf3n-de-la-base-de-datos.}{%
\subsection{Creación y descripción de la base de
datos.}\label{creaciuxf3n-y-descripciuxf3n-de-la-base-de-datos.}}

El primer paso para trabajar sobre una base de datos es, conocerla, es
decir, conocer el contenido de la base de datos y, además, ser capaces
de clasificar las diferentes variables en función de su clase o, lo que
es lo mismo, saber distinguir las variables continuas de las discretas
(categóricas).

Otro punto interesante es el de crear nuevas variables dependiendo de
los resultados que estamos buscando según nuestros intereses.

Leemos a continuación la base de datos:

\begin{verbatim}
 id gender age hypertension heart_disease ever_married     work_type
\end{verbatim}

1 9046 Male 67 0 1 Yes Private 2 51676 Female 61 0 0 Yes Self-employed 3
31112 Male 80 0 1 Yes Private 4 60182 Female 49 0 0 Yes Private 5 1665
Female 79 1 0 Yes Self-employed 6 56669 Male 81 0 0 Yes Private
Residence\_type avg\_glucose\_level bmi smoking\_status stroke 1 Urban
228.69 36.6 formerly smoked 1 2 Rural 202.21 NA never smoked 1 3 Rural
105.92 32.5 never smoked 1 4 Urban 171.23 34.4 smokes 1 5 Rural 174.12
24.0 never smoked 1 6 Urban 186.21 29.0 formerly smoked 1

Encontramos una base de datos que consta de 5110 observaciones y de 12
variables.

Algunas de estas variables sirven para identificar a cada una de las
personas que se ha hecho seguimiento, como son la edad o el género.
Otras, sin embargo, hacen referencia a temas de salud, como el nivel de
glucosa, el índice de masa corporal o si tienen o han tenido problemas
cardiovasculares.

Entendemos que es interesante, para este estudio, comprobar qué factores
pueden influir sobre el índice de masa corporal (BMI en inglés), tomamos
esta como nuestra variable objetivo.

Por último, encontramos variables que hacen referencia a hábitos de
personas, como pueden ser el tipo de trabajo y con que regularidad
fuman.

Breve descripción de las variables encontradas en la base de datos:

\begin{itemize}
\item \textbf {id:} es un identificador de los pacientes sobre los que se está realizando el estudio.
\item \textbf {gender:} hace referencia al sexo de los pacientes.
\item \textbf {age:} representa la edad, en años, de los pacientes.
\item \textbf {hypertension:} variable binaria que representa si el paciente tiene hipertensión o no.
\item \textbf {heart_disease:} indica si el paciente ha tenido previamente problemas cardiacos).
\item \textbf {ever_married:} indica si el paciente se ha casado o no.
\item \textbf {work_type:} tipo de trabajo, clasificado de la siguiente forma: Govt_job (funcionario), Private (trabajador del sector privado), Self-employed \item \textbf (autónomo), Never_worked (sin ningún tipo de experiencia laboral) y children (niño y, por tanto, sin experiencia laboral).
\item \textbf {residence_type:} localización geográfica de la residencia en la que habita el paciente, puede ser rural (área rural) o urban (área urbana).
\item \textbf {avg_glucose_level:} nivel de glucosa media del paciente medida en mg/dL
\item \textbf {bmi:} índice de masa corporal del paciente
\item \textbf {smoking_status:} hábito de consumo de tabaco del paciente, clasificado de la siguiente forma: smokes (fumador actual), formerly smoked (fumador en \item \textbf el pasado) y never smoked (nunca ha fumado)
\item \textbf {stroke:} variable binaria que indica si el paciente ha tenido un ataque cardiaco (1) o no (0).
\end{itemize}

Vamos a eliminar la variable id ya que se trata de un identificador
empleado para diferenciar a los pacientes:

\hypertarget{limpieza-de-la-base-de-datos---estaduxedstica-descriptiva}{%
\subsection{Limpieza de la base de datos - estadística
descriptiva}\label{limpieza-de-la-base-de-datos---estaduxedstica-descriptiva}}

Una vez hemos definido las variables y sabemos lo que significan,
tenemos que depurar la base de datos para poder trabajar con ella.

En la variable gender, observamos que hay una única obsevación (no
significativa) que adopta el valor Other, la convertimos en NA:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df}\SpecialCharTok{$}\NormalTok{gender }\OtherTok{\textless{}{-}} \FunctionTok{ifelse}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{gender }\SpecialCharTok{==} \StringTok{"Other"}\NormalTok{, }\ConstantTok{NA}\NormalTok{, df}\SpecialCharTok{$}\NormalTok{gender)}
\end{Highlighting}
\end{Shaded}

De las variables que hemos elegido el índice de masa corportal (bmi)
tiene 3.9\% de variables que son NA, por tanto, eliminaremos esas
observaciones. Por otro lado existe un número significativo de
observaciones que tienen variable smoking\_status de valor Unknown,
realizamos un breve análisis de su relación con el bmi.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{boxplot}\NormalTok{(bmi}\SpecialCharTok{\textasciitilde{}}\NormalTok{smoking\_status, }\AttributeTok{data=}\NormalTok{df)}
\end{Highlighting}
\end{Shaded}

\includegraphics{P1_AlfredoRobledano_RubenSierra_files/figure-latex/unnamed-chunk-4-1.pdf}
Si realizamos un diagrama de cajas que relacione las variables bmi y
smoking\_status observamos que entre las variables que no son unknown no
hay mucha diferencia, pero esta si difiere y por tanto al realizar anova
saldría como valor de variable significativo unknown pero realmente no
sabríamos porque al no especificarse un valor concreto. Descartamos esas
observaciones al no darnos información útil.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df}\SpecialCharTok{$}\NormalTok{smoking\_status }\OtherTok{\textless{}{-}} \FunctionTok{ifelse}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{smoking\_status }\SpecialCharTok{==} \StringTok{"Unknown"}\NormalTok{, }\ConstantTok{NA}\NormalTok{, df}\SpecialCharTok{$}\NormalTok{smoking\_status)}
\end{Highlighting}
\end{Shaded}

Hemos convertido en NA todos aquellos valores de variables de
observaciones no útiles.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(inspectdf);}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: package 'inspectdf' was built under R version 4.2.3
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{show\_plot}\NormalTok{(}\FunctionTok{inspect\_na}\NormalTok{(df))}
\end{Highlighting}
\end{Shaded}

\includegraphics{P1_AlfredoRobledano_RubenSierra_files/figure-latex/unnamed-chunk-6-1.pdf}
Eliminamos todas aquellas observaciones no útiles.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{na.omit}\NormalTok{(df)}
\FunctionTok{show\_plot}\NormalTok{(}\FunctionTok{inspect\_na}\NormalTok{(df))}
\end{Highlighting}
\end{Shaded}

\includegraphics{P1_AlfredoRobledano_RubenSierra_files/figure-latex/unnamed-chunk-7-1.pdf}

Lo siguiente que debemos realizar es un estudio de la naturaleza de las
variables, es decir, asignar el tipo factor a aquellas que consideremos
categóricas y comprobar que las numéricas estén bien identificadas:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{show\_plot}\NormalTok{(}\FunctionTok{inspect\_types}\NormalTok{(df))}
\end{Highlighting}
\end{Shaded}

\includegraphics{P1_AlfredoRobledano_RubenSierra_files/figure-latex/unnamed-chunk-8-1.pdf}

Tenemos 5 variables de tipo char que pasaremos a factor. Además, debemos
pasar a factor las variables que representan categorías aún siendo
variables numéricas, en nuestro caso las variable hypertension,
heart\_disease y stroke.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df[,}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{11}\NormalTok{)] }\OtherTok{\textless{}{-}} \FunctionTok{lapply}\NormalTok{(df[,}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{3}\NormalTok{, }\DecValTok{4}\NormalTok{, }\DecValTok{5}\NormalTok{, }\DecValTok{6}\NormalTok{, }\DecValTok{7}\NormalTok{, }\DecValTok{10}\NormalTok{, }\DecValTok{11}\NormalTok{)], factor)}
\FunctionTok{summary}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     gender          age        hypertension heart_disease ever_married
##  Female:2086   Min.   :10.00   0:3017       0:3219        No : 826    
##  Male  :1339   1st Qu.:34.00   1: 408       1: 206        Yes:2599    
##                Median :50.00                                          
##                Mean   :48.65                                          
##                3rd Qu.:63.00                                          
##                Max.   :82.00                                          
##          work_type    Residence_type avg_glucose_level      bmi       
##  children     :  68   Rural:1680     Min.   : 55.12    Min.   :11.50  
##  Govt_job     : 514   Urban:1745     1st Qu.: 77.23    1st Qu.:25.30  
##  Never_worked :  14                  Median : 92.35    Median :29.10  
##  Private      :2200                  Mean   :108.31    Mean   :30.29  
##  Self-employed: 629                  3rd Qu.:116.20    3rd Qu.:34.10  
##                                      Max.   :271.74    Max.   :92.00  
##          smoking_status stroke  
##  formerly smoked: 836   0:3245  
##  never smoked   :1852   1: 180  
##  smokes         : 737           
##                                 
##                                 
## 
\end{verbatim}

Observamos que hay 3 variables continuas, de las que posteriormente
estudiaremos las distribuciones y se tomarán las decisiones oportunas: •
age: Edad de cada individuo. • avg\_glucose\_level: Nivel de glugosa
promedio de cada individuo • bmi: Índice de masa corporal de cada
individuo En contraposición, hay 5 variables discretas: • gender: Sexo
de los pacientes. • hypertension: Determina si los pacientes tienen
hipertensión. • heart\_disease: Determina si los pacientes han tenido
problemas cardiacos. • work\_type: Tipo de trabajo que ejerce el
paciente. • ever\_married: Determina si los pacientes se han casado. •
Residence\_type: Lugar de residencia de los pacientes. •
smoking\_status: Nivel de tabaquismo de los pacientes. • stroke:
Determina si el paciente ha tenido previamente infartos.

Nos podemos percatar que la variable edad puede tomar valores no
enteros, por simplicidad convertiremos la edad a valores enteros y
trabajaremos en meses porque parte de la muestra son bebés.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df[}\DecValTok{2}\NormalTok{]}\OtherTok{\textless{}{-}}\FunctionTok{lapply}\NormalTok{(df[}\DecValTok{2}\NormalTok{],}\ControlFlowTok{function}\NormalTok{(x) }\FunctionTok{round}\NormalTok{(x}\SpecialCharTok{*}\DecValTok{12}\NormalTok{))}
\FunctionTok{colnames}\NormalTok{(df)[}\DecValTok{2}\NormalTok{]  }\OtherTok{\textless{}{-}} \StringTok{"months"}  
\FunctionTok{summary}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     gender         months      hypertension heart_disease ever_married
##  Female:2086   Min.   :120.0   0:3017       0:3219        No : 826    
##  Male  :1339   1st Qu.:408.0   1: 408       1: 206        Yes:2599    
##                Median :600.0                                          
##                Mean   :583.8                                          
##                3rd Qu.:756.0                                          
##                Max.   :984.0                                          
##          work_type    Residence_type avg_glucose_level      bmi       
##  children     :  68   Rural:1680     Min.   : 55.12    Min.   :11.50  
##  Govt_job     : 514   Urban:1745     1st Qu.: 77.23    1st Qu.:25.30  
##  Never_worked :  14                  Median : 92.35    Median :29.10  
##  Private      :2200                  Mean   :108.31    Mean   :30.29  
##  Self-employed: 629                  3rd Qu.:116.20    3rd Qu.:34.10  
##                                      Max.   :271.74    Max.   :92.00  
##          smoking_status stroke  
##  formerly smoked: 836   0:3245  
##  never smoked   :1852   1: 180  
##  smokes         : 737           
##                                 
##                                 
## 
\end{verbatim}

Analizando el summary, la media y el tercer cuartil del IMC y de los
niveles de glucosa distan mucho de sus valores máximos, por tanto,
podemos concluir que tiene valores outliners.

Lo primero que tenemos que hacer para eliminar los outliners es graficar
las funciones numéricas para observa cuánto se aleja la cola del resto
de la función:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(inspectdf);}
\FunctionTok{show\_plot}\NormalTok{(}\FunctionTok{inspect\_num}\NormalTok{(df))}
\end{Highlighting}
\end{Shaded}

\includegraphics{P1_AlfredoRobledano_RubenSierra_files/figure-latex/unnamed-chunk-11-1.pdf}

En el IMC, los outliners son los valores que se escapan por las colas,
de tal forma que una persona es muy extraño que tenga un IMC ínfimo o
superior al 50\%. Por tanto, nuestros outliners serán los valores
menores a un 15\% y mayores a un 50\%:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{subset}\NormalTok{(df, bmi }\SpecialCharTok{\textgreater{}} \DecValTok{15} \SpecialCharTok{\&}\NormalTok{ bmi }\SpecialCharTok{\textless{}} \DecValTok{50}\NormalTok{)}
\FunctionTok{summary}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     gender         months      hypertension heart_disease ever_married
##  Female:2042   Min.   :120.0   0:2972       0:3159        No : 814    
##  Male  :1322   1st Qu.:405.0   1: 392       1: 205        Yes:2550    
##                Median :600.0                                          
##                Mean   :584.3                                          
##                3rd Qu.:756.0                                          
##                Max.   :984.0                                          
##          work_type    Residence_type avg_glucose_level      bmi       
##  children     :  68   Rural:1647     Min.   : 55.12    Min.   :15.30  
##  Govt_job     : 505   Urban:1717     1st Qu.: 77.22    1st Qu.:25.20  
##  Never_worked :  14                  Median : 92.30    Median :28.95  
##  Private      :2156                  Mean   :108.04    Mean   :29.86  
##  Self-employed: 621                  3rd Qu.:116.00    3rd Qu.:33.70  
##                                      Max.   :271.74    Max.   :49.90  
##          smoking_status stroke  
##  formerly smoked: 822   0:3185  
##  never smoked   :1817   1: 179  
##  smokes         : 725           
##                                 
##                                 
## 
\end{verbatim}

En los niveles de glucosa, los outliners son los valores que se escapan
por las colas, de tal forma que una persona es muy extraño que tenga un
nivel de glucosa superior a los 250 mg/dL:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{subset}\NormalTok{(df, avg\_glucose\_level}\SpecialCharTok{\textless{}} \DecValTok{225}\NormalTok{)}
\FunctionTok{summary}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##     gender         months      hypertension heart_disease ever_married
##  Female:1976   Min.   :120.0   0:2874       0:3049        No : 804    
##  Male  :1257   1st Qu.:396.0   1: 359       1: 184        Yes:2429    
##                Median :588.0                                          
##                Mean   :577.2                                          
##                3rd Qu.:744.0                                          
##                Max.   :984.0                                          
##          work_type    Residence_type avg_glucose_level      bmi       
##  children     :  68   Rural:1579     Min.   : 55.12    Min.   :15.30  
##  Govt_job     : 488   Urban:1654     1st Qu.: 76.46    1st Qu.:25.10  
##  Never_worked :  14                  Median : 91.02    Median :28.80  
##  Private      :2077                  Mean   :102.76    Mean   :29.74  
##  Self-employed: 586                  3rd Qu.:111.96    3rd Qu.:33.50  
##                                      Max.   :224.71    Max.   :49.90  
##          smoking_status stroke  
##  formerly smoked: 782   0:3075  
##  never smoked   :1752   1: 158  
##  smokes         : 699           
##                                 
##                                 
## 
\end{verbatim}

\hypertarget{anuxe1lisis-a-priori---influencia-de-las-variables.}{%
\section{Análisis a priori - influencia de las
variables.}\label{anuxe1lisis-a-priori---influencia-de-las-variables.}}

Ahora que conocemos la base de datos y la hemos depurado, vamos a
empezar a sacar algunas conclusiones. Por ejemplo, nos podría interesar
comprobar si el índice de masa corporal viene influido por el
tabaquismo:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{boxplot}\NormalTok{(bmi }\SpecialCharTok{\textasciitilde{}}\NormalTok{ smoking\_status, }\AttributeTok{data =}\NormalTok{ df, }\AttributeTok{ylab =} \StringTok{"IMC"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{"Tabaquismo"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{P1_AlfredoRobledano_RubenSierra_files/figure-latex/unnamed-chunk-14-1.pdf}
También podría ser interesante mirar la influencia entre los problemas
cardiacos, tener hipertensión, el sexo o si viven en el campo y el IMC:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{boxplot}\NormalTok{(bmi }\SpecialCharTok{\textasciitilde{}}\NormalTok{ heart\_disease, }\AttributeTok{data =}\NormalTok{ df, }\AttributeTok{ylab =} \StringTok{"IMC"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{"Cardiopatías"}\NormalTok{, }\AttributeTok{names =} \FunctionTok{c}\NormalTok{(}\StringTok{"No"}\NormalTok{, }\StringTok{"Sí"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{P1_AlfredoRobledano_RubenSierra_files/figure-latex/unnamed-chunk-15-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{boxplot}\NormalTok{(bmi }\SpecialCharTok{\textasciitilde{}}\NormalTok{ hypertension, }\AttributeTok{data =}\NormalTok{ df, }\AttributeTok{ylab =} \StringTok{"IMC"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{"Hipertensión"}\NormalTok{, }\AttributeTok{names =} \FunctionTok{c}\NormalTok{(}\StringTok{"No"}\NormalTok{, }\StringTok{"Sí"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{P1_AlfredoRobledano_RubenSierra_files/figure-latex/unnamed-chunk-15-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{boxplot}\NormalTok{(bmi  }\SpecialCharTok{\textasciitilde{}}\NormalTok{  gender, }\AttributeTok{data =}\NormalTok{ df, }\AttributeTok{ylab =} \StringTok{"IMC"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{"Sexo"}\NormalTok{, }\AttributeTok{names =} \FunctionTok{c}\NormalTok{(}\StringTok{"Mujeres"}\NormalTok{, }\StringTok{"Hombres"}\NormalTok{) )}
\end{Highlighting}
\end{Shaded}

\includegraphics{P1_AlfredoRobledano_RubenSierra_files/figure-latex/unnamed-chunk-15-3.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{boxplot}\NormalTok{(bmi  }\SpecialCharTok{\textasciitilde{}}\NormalTok{  Residence\_type, }\AttributeTok{data =}\NormalTok{ df, }\AttributeTok{ylab =} \StringTok{"IMC"}\NormalTok{, }\AttributeTok{xlab =} \StringTok{"Residencia"}\NormalTok{, }\AttributeTok{names =} \FunctionTok{c}\NormalTok{(}\StringTok{"Rural"}\NormalTok{, }\StringTok{"Urbana"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{P1_AlfredoRobledano_RubenSierra_files/figure-latex/unnamed-chunk-15-4.pdf}
Vamos a comprobar, de forma gráfica, si el sexo puede afectar a la
hipertensión, los ataques cardiacos y las cardiopatías. De esta forma,
en el futuro, podremos realizar más comprobaciones de forma analítica.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{spineplot}\NormalTok{(}\FunctionTok{table}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{hypertension,df}\SpecialCharTok{$}\NormalTok{gender), }\AttributeTok{xaxlabels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Sin hipertensión"}\NormalTok{, }\StringTok{"Con hipertensión"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{P1_AlfredoRobledano_RubenSierra_files/figure-latex/unnamed-chunk-16-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{spineplot}\NormalTok{(}\FunctionTok{table}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{stroke,df}\SpecialCharTok{$}\NormalTok{gender), }\AttributeTok{xaxlabels =} \FunctionTok{c}\NormalTok{(}\StringTok{"No ataque cardiaco"}\NormalTok{, }\StringTok{"Ataque cardiaco"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{P1_AlfredoRobledano_RubenSierra_files/figure-latex/unnamed-chunk-16-2.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{spineplot}\NormalTok{(}\FunctionTok{table}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{heart\_disease,df}\SpecialCharTok{$}\NormalTok{gender), }\AttributeTok{xaxlabels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Sin cardiopatías"}\NormalTok{, }\StringTok{"Con cardiopatías"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\includegraphics{P1_AlfredoRobledano_RubenSierra_files/figure-latex/unnamed-chunk-16-3.pdf}
\# Intervalo de confianza En este apartado crearemos un intervalo de
confianza para el IMC. Hemos visto anteriormente el estimador puntual
para este valor, aproximadamente el 29.7\%, pero vamos a crear un
intervalo de confianza para este valor y poder estimar cuánto valdría
este valor en la población.

Queremos hacer el intervalo de confianza para el IMC \textbf{media}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Intervalo para la media }

\NormalTok{conf }\OtherTok{\textless{}{-}} \FunctionTok{t.test}\NormalTok{(}\AttributeTok{x =}\NormalTok{  df}\SpecialCharTok{$}\NormalTok{bmi,                   }\CommentTok{\# Muestra 1}
               \AttributeTok{y =} \ConstantTok{NULL}\NormalTok{,                      }\CommentTok{\# Muestra 2}
               \AttributeTok{alternative =} \FunctionTok{c}\NormalTok{(}\StringTok{"two.sided"}\NormalTok{),  }\CommentTok{\# Tipo de intervalo}
               \AttributeTok{paired =} \ConstantTok{FALSE}\NormalTok{,                }\CommentTok{\# Variables dependientes}
               \AttributeTok{var.equal =} \ConstantTok{FALSE}\NormalTok{,             }\CommentTok{\# Varianzas iguales}
               \AttributeTok{conf.level =} \FloatTok{0.95}\NormalTok{)             }\CommentTok{\# Nivel de confianza (1{-}nivel significación)}

\CommentTok{\# Muestro el resultado del intervalo}

\NormalTok{conf}\SpecialCharTok{$}\NormalTok{conf.int}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 29.51491 29.95574
## attr(,"conf.level")
## [1] 0.95
\end{verbatim}

\hypertarget{contraste-de-hipuxf3tesis}{%
\section{Contraste de hipótesis}\label{contraste-de-hipuxf3tesis}}

Hemos visto de forma gráfica, que la residencia no afectaba al IMC pero
tener hipertensión sí podía influir.

Crearemos un primer contraste de forma analítica para comprobar que la
media de IMC entre los que viven en el campo y en la ciudad es igual. Es
decir, queremos plantear el siguiente contraste de hipótesis:

\[ \left\{ \begin{array}{lc}
             H_{0}: & \mu_{rural} = \mu_{urbano} \\
             H_{1}: & \mu_{rural} \neq \mu_{urbano}
             \end{array}
\right. \]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Contraste para la diferencia de medias}
\NormalTok{rural }\OtherTok{\textless{}{-}}\NormalTok{ df[df}\SpecialCharTok{$}\NormalTok{Residence\_type }\SpecialCharTok{==} \StringTok{\textquotesingle{}Rural\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}bmi\textquotesingle{}}\NormalTok{]}
\NormalTok{urbano }\OtherTok{\textless{}{-}}\NormalTok{ df[df}\SpecialCharTok{$}\NormalTok{Residence\_type }\SpecialCharTok{==} \StringTok{\textquotesingle{}Urban\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}bmi\textquotesingle{}}\NormalTok{]}

\FunctionTok{t.test}\NormalTok{(}\AttributeTok{x =}\NormalTok{ rural,                   }\CommentTok{\# Muestra 1}
       \AttributeTok{y =}\NormalTok{ urbano,                   }\CommentTok{\# Muestra 2}
       \AttributeTok{alternative =} \FunctionTok{c}\NormalTok{(}\StringTok{"two.sided"}\NormalTok{),  }\CommentTok{\# Signo hipótesis alternativa}
       \AttributeTok{paired =} \ConstantTok{FALSE}\NormalTok{,                }\CommentTok{\# Variables dependientes}
       \AttributeTok{var.equal =} \ConstantTok{FALSE}\NormalTok{,             }\CommentTok{\# Varianzas iguales}
       \AttributeTok{conf.level =} \FloatTok{0.95}\NormalTok{)             }\CommentTok{\# Nivel de confianza (1{-}nivel significación)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Welch Two Sample t-test
## 
## data:  rural and urbano
## t = -0.19098, df = 3230.3, p-value = 0.8486
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -0.4836161  0.3977663
## sample estimates:
## mean of x mean of y 
##  29.71336  29.75629
\end{verbatim}

Como el p-valor es mayor que el nivel de significación, podemos concluir
que no hay evidencias suficientes para rechazar \(H_{0}\) y por tanto no
existen diferencias entre el IMC entre las personas que tienen
residencia rural y residencia urbana.

Ahora vamos a comprobar qué pasa con las personas con hipertensión. Para
ello, vamos a plantear la siguiente hipótesis, pues gráficamente es la
que hemos visto que se cumple:

\[ \left\{ \begin{array}{lc}
             H_{0}: & \mu_{hipertensión} \leq \mu_{no hipertensión} \\
             H_{1}: & \mu_{hipertensión} > \mu_{no hipertensión}
             \end{array}
   \right. \]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Contraste para la diferencia de medias}

\NormalTok{yes }\OtherTok{\textless{}{-}}\NormalTok{ df[df}\SpecialCharTok{$}\NormalTok{hypertension }\SpecialCharTok{==} \DecValTok{1}\NormalTok{, }\StringTok{\textquotesingle{}bmi\textquotesingle{}}\NormalTok{]}
\NormalTok{no }\OtherTok{\textless{}{-}}\NormalTok{ df[df}\SpecialCharTok{$}\NormalTok{hypertension }\SpecialCharTok{==} \DecValTok{0}\NormalTok{, }\StringTok{\textquotesingle{}bmi\textquotesingle{}}\NormalTok{]}

\FunctionTok{t.test}\NormalTok{(}\AttributeTok{x =}\NormalTok{ yes,                       }\CommentTok{\# Muestra 1}
       \AttributeTok{y =}\NormalTok{ no,                        }\CommentTok{\# Muestra 2}
       \AttributeTok{alternative =} \FunctionTok{c}\NormalTok{(}\StringTok{"greater"}\NormalTok{),    }\CommentTok{\# Signo hipótesis alternativa}
       \AttributeTok{paired =} \ConstantTok{FALSE}\NormalTok{,                }\CommentTok{\# Variables dependientes}
       \AttributeTok{var.equal =} \ConstantTok{FALSE}\NormalTok{,             }\CommentTok{\# Varianzas iguales}
       \AttributeTok{conf.level =} \FloatTok{0.99}\NormalTok{)             }\CommentTok{\# Nivel de confianza (1{-}nivel significación)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
##  Welch Two Sample t-test
## 
## data:  yes and no
## t = 6.5064, df = 463.38, p-value = 1e-10
## alternative hypothesis: true difference in means is greater than 0
## 99 percent confidence interval:
##  1.42336     Inf
## sample estimates:
## mean of x mean of y 
##  31.70864  29.48883
\end{verbatim}

El p-valor es pequeño, lo que quiere decir que nuestro estadístico de
diferencia de medias está en la región crítica, por lo que tenemos
evidencias suficientes para rechazar la hipótesis nula y podemos
concluir que hay diferencia entre el IMC de personas con hipertensión y
las que no tienen hipertensión, teniendo las personas con hipertensión
un mayor IMC. \#ANOVA Por último, vamos a comprobar si el tabaquismo
puede influir en el IMC. Gráficamente hemos visto que las personas que
nunca han fumado suelen tener un IMC menor.

Definimos el siguiente contraste:

\[ \left\{ \begin{array}{lc}
             H_{0}: & \mu_{no fumador} = \mu_{exfumador} = \mu_{fumador}\\
             H_{1}: & Diferentes
             \end{array}
\right. \]

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Aplicamos ANOVA}
\NormalTok{anova\_str }\OtherTok{\textless{}{-}} \FunctionTok{aov}\NormalTok{(bmi }\SpecialCharTok{\textasciitilde{}}\NormalTok{ smoking\_status, }\AttributeTok{data =}\NormalTok{ df)}
\FunctionTok{summary}\NormalTok{(anova\_str)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                  Df Sum Sq Mean Sq F value  Pr(>F)   
## smoking_status    2    494  247.14   6.068 0.00234 **
## Residuals      3230 131557   40.73                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
\end{verbatim}

Como resultado, obtenemos la tabla de ANOVA vista en clase, con la
diferencia de encontrar el p-valor en lugar del valor teórico para la
distribución de la F.

El criterio de rechazo es el mismo que tenemos en los contrastes de
hipótesis, es decir, si el p-valor es mayor que el nivel de
significación, rechazamos \(H_{0}\).

En este caso tenemos un p-valor muy pequeño, bajo un nivel de
significación 0.05, rechazamos \(H_{0}\), es decir, no hay evidencias
suficientes para aceptar que las medias de IMC en los diferentes grupos
según si la persona nunca ha fumado, es exfumador o fuma actualmente
sean iguales. Podemos concluir que estas medias son diferentes y por
tanto, el tabaquismo sí es un factor influyente en el IMC.

\end{document}
